<#function getName code reference_list>
	<#if reference_list?has_content>
		<#list reference_list as reference_item>
			<#if reference_item.code = code>
  				<#return reference_item.name>
  			</#if>
  		</#list>
	</#if>
	<#return "">
</#function>

<#function getChecked code reference_list>
	<#if reference_list?has_content>
		<#list reference_list as reference_item>
			<#if reference_item.code = code>
				<#if reference_item.checked>
  					<#return "checked='checked'">
  				<#else>
  					<#return "">
  				</#if>
  			</#if>
  		</#list>
	</#if>
	<#return "">
</#function>
<div class="pull-right">
	<form action="jsp/admin/plugins/mylutece/modules/database/GetChangeUseAdvancedSecurityParameters.jsp" class="form-inline">
		<#if use_advanced_security_parameters>
			<button type="submit" class="btn btn-primary">#i18n{mylutece.manage_advanced_parameters.removeAdvancedSecurityParameters}</button>
		<#else>
			<button type="submit" class="btn btn-primary">#i18n{mylutece.manage_advanced_parameters.useAdvancedSecurityParameters}</button>
		</#if>
	</form>
</div>
<!-- PASSWORD ENCRYPTION -->
<form method="post" name="password_encryption" action="jsp/admin/plugins/mylutece/modules/database/ModifyPasswordEncryption.jsp">
<label  class="checkbox" for="enable_password_encryption">#i18n{module.mylutece.database.manage_advanced_parameters.labelEnablePasswordEncryption} 
	<input type="checkbox" class="checkbox" name="enable_password_encryption" value="true" <#if use_advanced_security_parameters>disabled="disabled"</#if> <#if enable_password_encryption>checked="checked"</#if> />
	</label>
	<#if use_advanced_security_parameters>
	<input type="hidden" name="enable_password_encryption" value="<#if enable_password_encryption!>true<#else>false</#if>"/>
	</#if>
	<label for="encryption_algorithm">#i18n{module.mylutece.database.manage_advanced_parameters.labelEncryptionAlgorithm} : </label>
	<select name="encryption_algorithm" <#if use_advanced_security_parameters>disabled="disabled"</#if>>
		<#if !encryption_algorithm?has_content>
			<option value="" selected="selected">#i18n{module.mylutece.database.manage_advanced_parameters.labelNoAlgorithm}</option>
		<#else>
			<option value="">#i18n{module.mylutece.database.manage_advanced_parameters.labelNoAlgorithm}</option>
		</#if>
		<#list encryption_algorithms_list as algorithm>
			<#if algorithm = encryption_algorithm>
				<option value="${algorithm}" selected="selected">${algorithm}</option>
			<#else>
				<option value=${algorithm}>${algorithm}</option>
			</#if>
		</#list>
		<#if use_advanced_security_parameters>
			<input type="hidden" name="encryption_algorithm" value="${encryption_algorithm!}"/>
		</#if>
	</select>
	<button type="submit" class="btn btn-primary"><i class="icon-ok icon-white"></i>&nbsp;#i18n{module.mylutece.database.manage_advanced_parameters.buttonModify}</button>
</form>
<fieldset>
<legend>#i18n{portal.users.manage_advanced_parameters.securityParameters}</legend>
	<form method="post" name="password_global_security" action="jsp/admin/plugins/mylutece/modules/database/DoModifyDatabaseUserParameters.jsp">
	<label class="checkbox" for="account_creation_validation_email">#i18n{module.mylutece.database.manage_advanced_parameters.labelAccountCreationValidationEmail}
		<input type="checkbox" class="checkbox"	name="account_creation_validation_email" value="true" <#if account_creation_validation_email?? && account_creation_validation_email>checked="checked"</#if> />
	</label>
	<p class="help-block">#i18n{module.mylutece.database.manage_advanced_parameters.labelAccountCreationValidationEmailComment}</p>
	<#if is_plugin_jcatpcha_enable>
	<label class="checkbox" for="enable_jcaptcha">#i18n{module.mylutece.database.manage_advanced_parameters.labelEnableCaptcha} : 
		<input class="checkbox" type="checkbox" name="enable_jcaptcha" value="true" <#if enable_jcaptcha?? && enable_jcaptcha>checked="checked"</#if> />
	</label>
	<p class="help-block">#i18n{module.mylutece.database.manage_advanced_parameters.labelEnableCaptchaComment}</p>
		</#if>
	<p>#i18n{module.mylutece.database.manage_advanced_parameters.labelPassword}</p>
	<label for="password_minimum_length">#i18n{mylutece.message.password.labelMinimumPasswordLength} * : </label>
		<input type="text" name="password_minimum_length" value="${password_minimum_length!}" />
	<#if use_advanced_security_parameters>
		<label class="checkbox" for="password_format">#i18n{mylutece.message.password.labelPasswordFormat}
			<input class="checkbox"  type="checkbox" name="password_format" id="password_format" value="true" <#if password_format?? && password_format>checked="checked"</#if> />
		</label>
		<label for="password_duration">#i18n{mylutece.message.password.labelPasswordDuration} : </label>
		<input type="text" name="password_duration" value="${password_duration!}" />
	</#if>
		<label class="checkbox" for="force_change_password_reinit">#i18n{mylutece.message.password.labelForceChangePasswordReinit}
			<input class="checkbox" type="checkbox" name="force_change_password_reinit" id="force_change_password_reinit" value="true" <#if force_change_password_reinit?? && force_change_password_reinit>checked="checked"</#if> />
		 </label>
	<#if use_advanced_security_parameters>
		<label for="password_history_size">#i18n{mylutece.message.password.labelPasswordHistorySize} : </label>
		<input type="text" name="password_history_size" value="${password_history_size!}" />
		<label for="maximum_number_password_change">#i18n{mylutece.message.password.labelMaxNumberPasswordChange} : </label>
		<input type="text" name="maximum_number_password_change" value="${maximum_number_password_change!}" />
			<label for="tsw_size_password_change">#i18n{mylutece.message.password.labelPasswordChangeTSWSize} : </label>
			<input type="text" name="tsw_size_password_change" value="${tsw_size_password_change!}" />
		</#if>
			<label for="access_failures_max">#i18n{mylutece.manage_advanced_parameters.labelAccesFailuresMax} : </label>
			<input type="text" name="access_failures_max" value="${access_failures_max!}" /><br />
			<label for="access_failures_interval">#i18n{mylutece.manage_advanced_parameters.labelAccesFailuresInterval} : </label>
			<input type="text" name="access_failures_interval" value="${access_failures_interval!}" />
			<label for="account_life_time">#i18n{mylutece.manage_advanced_parameters.labelAccountLifeTime} : </label>
			<input type="text" name="account_life_time" value="${account_life_time!}" />
			<label for="time_before_alert_account">#i18n{mylutece.manage_advanced_parameters.labelTimeBeforeAlert} : </label>
			<input type="text" name="time_before_alert_account" value="${time_before_alert_account!}" />
			<label for="nb_alert_account">#i18n{mylutece.manage_advanced_parameters.labelNbAlert} : </label>
			<input type="text" name="nb_alert_account" value="${nb_alert_account!}" />
			<label for="time_between_alerts_account">#i18n{mylutece.manage_advanced_parameters.labelTimeBetweenAlerts} : </label>
			<input type="text" name="time_between_alerts_account" value="${time_between_alerts_account!}" />
			<input type="submit" class="button" value="#i18n{module.mylutece.database.manage_advanced_parameters.buttonModify}" />
	</form>
</fieldset>
<fieldset>
<legend>#i18n{mylutece.accountLifeTime.labelLifeTimeNotifications}</legend>
<form method="post" action="jsp/admin/plugins/mylutece/modules/database/ModifyAccountLifeTimeEmails.jsp">
<label for="email_type">#i18n{mylutece.accountLifeTime.labelSelectEmail} :</label>
	<select name="email_type" >
		<option value="first" selected="selected" >#i18n{mylutece.accountLifeTime.labelFirstEmail}</option>
		<option value="other" >#i18n{mylutece.accountLifeTime.labelOtherEmail}</option>
	    <option value="expired" >#i18n{mylutece.accountLifeTime.labelAccountDeactivatedEmail}</option>
	    <option value="reactivated" >#i18n{mylutece.accountLifeTime.labelAccountUpdatedEmail}</option>
	</select>
	<input type="submit" class="button" value="#i18n{mylutece.accountLifeTime.labelEditEmail}" />
</form>
</fieldset>

